name: ğŸš€ è‡ªåŠ¨éƒ¨ç½²åˆ°VPS

on:
  push:
    branches: [ main ]

jobs:
  deploy:
    runs-on: ubuntu-latest
    
    steps:
    - name: ğŸ“¥ æ£€å‡ºä»£ç 
      uses: actions/checkout@v3
    
    - name: ğŸš€ éƒ¨ç½²åˆ°VPS
      uses: appleboy/ssh-action@v0.1.8
      with:
        host: 45.149.156.216
        username: root
        key: ${{ secrets.VPS_SSH_KEY }}
        script: |
          echo "ğŸ”„ å¼€å§‹è‡ªåŠ¨éƒ¨ç½²..."
          cd /var/www/research-dashboard
          
          # æ‹‰å–æœ€æ–°ä»£ç ï¼ˆåŒ…æ‹¬tar.gzï¼‰
          git pull
          
          # æ‰§è¡Œéƒ¨ç½²è„šæœ¬
          ./vps-update.sh
          
          echo "ğŸ‰ éƒ¨ç½²å®Œæˆï¼"
          echo "ğŸ“… éƒ¨ç½²æ—¶é—´: $(date)"